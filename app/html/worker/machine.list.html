<lx-dialog class="dialog dialog__scrollable dialog--l bgc-light-gradient" id='raiseIssueDialog' escape-close="true">
    <div class="dialog__header">
        <div class="toolbar bgc-indigo-800 pl++">
            <span class="toolbar__label tc-white fs-title">
                Raise Issue with {{Machines.eventFields.machineName}} - {{Machines.eventFields.toolName}} {{Machines.eventFields.type}}
            </span>       
            <span lx-dialog-close class="white">X</span>     
        </div>
    </div>
    <div class="dialog__content">   
      <lx-tabs links-tc="light" links-bgc="blue-500" indicator="yellow-500" no-divider="true" layout="inline">
        <lx-tab heading="Needs Attention">
          <div class="p++">
            <form name="Machines.alertForm" ng-submit="Machines.submitAlert()">          
              <formly-form model="Machines.eventFields" fields="Machines.alertFields"></formly-form>
              <div class="dialog__actions">
                <button class="btn btn--m btn--black btn--flat" lx-ripple lx-dialog-close>Cancel</button>
                <button type="submit" class="btn btn--m btn--black btn--flat" lx-ripple>Submit Alert</button>
              </div>    
          </form>
          </div>
        </lx-tab>
<!--         <lx-tab heading="Halt">
          <div class="p++">
            <form name="editMachine.haltForm" ng-submit="editMachine.submitHalt()">          
              <formly-form model="editMachine.eventFields" fields="editMachine.haltFields"></formly-form>
              <div class="dialog__actions">
                <button class="btn btn--m btn--black btn--flat" lx-ripple lx-dialog-close>Cancel</button>
                <button type="submit" class="btn btn--m btn--black btn--flat" lx-ripple>Submit Halt</button>
              </div>    
              </form>
          </div>
        </lx-tab>
 -->      </lx-tabs>
    </div>
</lx-dialog>


<div flex-container="row" flex-align="space-between center"><img src="img/aust.png" alt="" flex-item="2"></div>

<div ng-repeat="row in Machines.machines">
  <svg ng-class="Machines.getSVGClass(row)" xmlns="http://www.w3.org/2000/svg">
    <polygon points="200,100 160,160 240,160" style="fill:#bbb;stroke:black;stroke-width:2" />
    <g stroke="#114" stroke-width="2" 
          ng-click="Machines.raiseIssue(row,0,0,'Uncoiler')" 
          class="fillhover"
          lx-tooltip="Raise Issue with Uncoiler" tooltip-position="right">
      <circle cx="200" cy="100" r="40" fill="#eee"/>
      <text x="170" y="105" stroke-width="1" fill="black">UnCoiler</text>       
    </g>

    <rect x="250" y="100" ng-attr-width="{{250 + (row.baseComponents.length * 75)}}" 
      height="60" stroke="black" stroke-width="2" fill="#eee"/>
      <!-- ng-click="Machines.clickEdit(row)"/> -->
    <text transform="translate(270 140)">{{row.SiteName}} - {{row.Name}}</text>

    <g stroke="#114" stroke-width="2" 
          ng-click="Machines.raiseIssue(row,0,0,'Rollbed')" 
          class="fillhover"
          lx-tooltip="Roll Bed" tooltip-position="top">
  
    <rect x="250" y="60" width="30" height="40" fill="#eee"/>
      <circle cx="265" cy="73" r="6" fill="#ccc"/>
      <circle cx="265" cy="87" r="6" fill="#ccc"/>
    <rect x="285" y="60" width="30" height="40" fill="#eee"/>
      <circle cx="300" cy="73" r="6" fill="#ccc"/>
      <circle cx="300" cy="87" r="6" fill="#ccc"/>
    <rect x="320" y="60" width="30" height="40" fill="#eee"/>
      <circle cx="335" cy="73" r="6" fill="#ccc"/>
      <circle cx="335" cy="87" r="6" fill="#ccc"/>
    <rect x="355" y="60" width="30" height="40" fill="#eee"/>
      <circle cx="370" cy="73" r="6" fill="#ccc"/>
      <circle cx="370" cy="87" r="6" fill="#ccc"/>

    <rect x="430" y="60" width="30" height="40" fill="#eee"/>
      <circle cx="445" cy="73" r="6" fill="#ccc"/>
      <circle cx="445" cy="87" r="6" fill="#ccc"/>
    <rect x="465" y="60" width="30" height="40" fill="#eee"/>
      <circle cx="480" cy="73" r="6" fill="#ccc"/>
      <circle cx="480" cy="87" r="6" fill="#ccc"/>
    </g>

    <svg ng-repeat="comp in row.baseComponents" 
         ng-attr-x="{{500 + $index * 75}}" 
         lx-tooltip="{{comp.Name}}" tooltip-position="bottom"
         ng-click="Machines.raiseIssue(row,comp,comp.ID,'tool')">
      <a>
      <rect x="25" y="0" width="20" height="20" stroke="black" stroke-width="1" fill="#ddd"/>
      <rect y="20" width="70" rx="10" ry="10" height="80" stroke="black" stroke-width="2" 
            ng-attr-fill="{{Machines.toolFill(comp)}}"
            class="hoverme"/>
      <text x="5" y="50">{{$index + 1}}</text>
      </a>
    </svg>

<!--     <svg ng-repeat="comp in row.baseComponents" 
         ng-attr-x="{{350 + row.baseComponents.length * 75}}" 
         ng-click="Machines.raiseIssue(row,comp,comp.ID,'')">
      <a>
      <text x="50" ng-attr-y="{{30 + $index * 20}}">{{$index+1}} {{comp.Name}}</text>
      </a>
    </svg>
 -->
    <g stroke="#114" stroke-width="2" 
          ng-click="Machines.raiseIssue(row,0,0,'Electrical')" 
          class="fillhover"
          lx-tooltip="Raise Issue - Electrical" tooltip-position="right">
      <rect x="10" y="10" width="100" rx="10" ry="10" height="30" fill="#eee" class="fillhover"/>
      <text x="20" y="30" fill="black" stroke-width="1">Electrical</text>
    </g>
    <g stroke="#114" stroke-width="2" 
          ng-click="Machines.raiseIssue(row,0,0,'Hydraulic')" 
          class="fillhover"
          lx-tooltip="Raise Issue - Hydraulic" tooltip-position="right">
      <rect x="10" y="50" width="100" rx="10" ry="10" height="30" fill="#eee" class="fillhover"/>
      <text x="20" y="70" fill="black" stroke-width="1">Hydraulic</text>
    </g>
    <g stroke="#114" stroke-width="2" 
          ng-click="Machines.raiseIssue(row,0,0,'Printer')" 
          class="fillhover"
          lx-tooltip="Raise Issue - Printer" tooltip-position="right">
      <rect x="10" y="90" width="100" rx="10" ry="10" height="30" fill="#eee" class="fillhover"/>
      <text x="20" y="110" fill="black" stroke-width="1">Printer</text>
    </g>
    <g stroke="#114" stroke-width="2" 
          ng-click="Machines.raiseIssue(row,0,0,'Console')" 
          class="fillhover"
          lx-tooltip="Raise Issue - Console" tooltip-position="right">
      <rect x="10" y="130" width="100" rx="10" ry="10" height="30" fill="#eee" class="fillhover"/>
      <text x="20" y="150" fill="black" stroke-width="1">Console</text>
    </g>
<!-- 
    <text x="220" y="200">Hydraulic</text>
    <rect x="210" y="175" width="100" rx="10" ry="10" height="45" 
      stroke="black" stroke-width="2" fill="white" class="fillhover" opacity="0.5"
      lx-tooltip="Raise Issue - Hydraulic" tooltip-position="top"
      ng-click="Machines.raiseIssue(row,0,0,'Hydraulic')"/>
    <text x="330" y="200">Printer</text>
    <rect x="320" y="175" width="100" rx="10" ry="10" height="45" 
      stroke="black" stroke-width="2" fill="white" class="fillhover" opacity="0.5"
      lx-tooltip="Raise Issue - Printer" tooltip-position="top"
      ng-click="Machines.raiseIssue(row,0,0,'Printer')"/>
    <text x="440" y="200">Console</text>
    <rect x="430" y="175" width="100" rx="10" ry="10" height="45" 
      stroke="black" stroke-width="2" fill="white" class="fillhover" opacity="0.5"
      lx-tooltip="Raise Issue - Console" tooltip-position="top"
      ng-click="Machines.raiseIssue(row,0,0,'Console')"/>
 -->
  </svg>
</div>
